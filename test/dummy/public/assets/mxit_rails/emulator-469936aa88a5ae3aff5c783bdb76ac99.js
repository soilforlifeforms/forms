Emulator=function(){var t=window.History;t.Adapter.bind(window,"statechange",function(){var e=t.getState();e.data.url&&Emulator.setUrl(e.data.url)});var e={BACKSPACE:8,ENTER:13,ESCAPE:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,ZERO:48,NINE:57,A:65,Z:90};return{activeLink:0,setCookie:function(){$.cookie("x-mxit-userid-r",localStorage.getItem("mxit-id"),{path:"/"}),$.cookie("x-mxit-login",localStorage.getItem("mxit-login"),{path:"/"}),$.cookie("x-mxit-nick",localStorage.getItem("mxit-nick"),{path:"/"}),$.cookie("x-mxit-contact",localStorage.getItem("mxit-contact"),{path:"/"}),$.cookie("x-mxit-location",localStorage.getItem("mxit-location"),{path:"/"}),$.cookie("x-mxit-profile",localStorage.getItem("mxit-profile"),{path:"/"}),$.cookie("x-mxit-device-info",localStorage.getItem("mxit-distribution-code")+","+localStorage.getItem("mxit-msisdn"),{path:"/"}),$.cookie("ua-pixels","240x320",{path:"/"}),$.cookie("x-device-user-agent","EMULATOR",{path:"/"}),MXIT_PATH&&""!=MXIT_PATH?Emulator.setUrl(MXIT_PATH):Emulator.home()},home:function(){Emulator.setUrl(MXIT_ROOT)},getUrl:function(){if("undefined"!=typeof $("#center").attr("src")){var t=Emulator.iframe().location.pathname;return Emulator.iframe().location.search&&(t+=Emulator.iframe().location.search),t}return null},setUrl:function(t){if(Emulator.getUrl()!=t){var e=t;"/"!=e[0]&&(e="/"+e),$("#center").attr("src",e)}},editCredentials:function(){$("#center").hide(),$("#inputs").show(),$("#link").hide(),values=["id","login","nick","contact","location","profile","distribution-code","msisdn"];for(var t in values){var e=values[t],i=localStorage.getItem("mxit-"+e);$("#mxit-"+e+"-input").val(i)}},clearCredentials:function(){values=["id","login","nick","contact","location","profile","distribution-code","msisdn"];for(var t in values){var e=values[t];$("#mxit-"+e+"-input").val("")}},saveCredentials:function(){values=["id","login","nick","contact","location","profile",,"distribution-code","msisdn"];for(var t in values){var e=values[t],i=$("#mxit-"+e+"-input").val();""==i&&(i=$("#mxit-"+e+"-input").attr("placeholder")),localStorage.setItem("mxit-"+e,i)}$("#inputs").hide(),$("#center").show(),$("#link").show(),Emulator.setCredentials()},setCredentials:function(){Emulator.setCookie(),$("#registered").show(),$("#not-registered").hide(),localStorage.getItem("mxit-login")?($("#mxit-login-id-label").html("Login"),$("#mxit-login-id").html(localStorage.getItem("mxit-login"))):localStorage.getItem("mxit-id")?($("#mxit-login-id-label").html("ID"),$("#mxit-login-id").html(localStorage.getItem("mxit-id"))):($("#not-registered").show(),$("#registered").hide())},iframe:function(){return $("#center")[0].contentWindow},iframeElement:function(t){return $(t,Emulator.iframe().document)},collapse:function(){$("body").removeClass("collapse")},expand:function(){$("body").addClass("collapse")},expandCollapse:function(t){t&&("expand"==t?localStorage.setItem("expanded",!0):localStorage.removeItem("expanded"));var e=localStorage.getItem("expanded");e?Emulator.expand():Emulator.collapse()},refresh:function(){Emulator.iframe().location.reload()},updateIframe:function(){var e=Emulator.getUrl();e&&t.pushState({url:e},"","/emulator"+e),Emulator.iframeElement("body").addClass("emulator"),Emulator.iframeElement("body").on("keydown",$.proxy(Emulator,"key")),this.hasInput()?($("#phone-input").attr("disabled",!1),this.activeLink=this.numLinks()):($("#phone-input").attr("disabled","disabled").blur(),this.activeLink=0),this.focusLink(),Emulator.iframeElement("#env_dump").length>0&&Emulator.iframeElement("#session_dump").length>0?Emulator.expand():Emulator.expandCollapse()},key:function(t){(t.keyCode==e.UP||t.keyCode==e.DOWN)&&(t.keyCode==e.UP?this.activeLink--:this.activeLink++,this.focusLink())},hasInput:function(){return Emulator.iframeElement("form").length>0},numLinks:function(){return Emulator.iframeElement("a").length},focusLink:function(){var t=this.numLinks(),e=this.hasInput()?t:t-1;this.activeLink<0&&(this.activeLink=e),this.activeLink>e&&(this.activeLink=0),this.activeLink==t?this.focusInput():$(Emulator.iframeElement("a")[this.activeLink]).focus()},focusInput:function(){this.hasInput()?$("#phone-input").attr("disabled",!1).focus():$("#phone-input").attr("disabled","disabled").blur()},submit:function(t){t.charCode==e.ENTER&&Emulator.iframeElement("form").length>0&&(Emulator.iframeElement("input[type=text]").val($("#phone-input").val()),Emulator.iframeElement("input[type=submit]").click(),$("#phone-input").val(""))}}}(),$(function(){Emulator.setCredentials(),Emulator.expandCollapse(),$("body").on("keydown",$.proxy(Emulator,"key")),$("#phone-input").on("keypress",$.proxy(Emulator,"submit"))});